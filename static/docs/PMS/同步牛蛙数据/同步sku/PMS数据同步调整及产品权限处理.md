# PMS数据同步调整及产品权限处理

> 作者：lixizhou

一、同步数据逻辑调整（SKU归属、开发模式、专员、新增是否接管字段）（所涉及字段均在v2_products表）

1.SKU归属：根据第二点来处理，目前第二点方案未完全确定

2.开发模式对应牛蛙的开发属性（product_kf_shuxing）： 
            0.既不是精品也不是精铺
            1.精品
            2.精铺
            3.精铺&精品
其中：牛蛙值为0时PMS也处理为既不是精品也不是精铺，值为3时PMS处理为精品

3.专员：牛蛙原product_kf_id被分解成了精品专员和精铺专员字段，如果product_kf_id是0，则看product_dj_id字段，说明此SKU是做精铺且当前负责人是该user_id（目前PMS这两个字段也是同步牛蛙的，所以这点不用动）

4.新增是否接管字段：是否精品接管（product_jingpin_jieguan）和是否精铺接管（product_jingpu_jieguan）为是否接管别人的精铺/精品的标志，0未知，12 是否（此字段是产品开发手工维护）

&lt;br/>


二、产品与平台和租户之间权限的设置（平台可见、部门/租户可见、店铺可见）

1.SaaS平台可见：
      部门可见和店铺可见均为空，则默认为SaaS平台可见


2.部门可见（product_section_id）：牛蛙部门可见有值时则PMS为某租户可见（目前牛蛙是以OA组织架构来设置部门可见，但是OA组织架构对应哪个租户还未知，因此需要下面几点来确认）
A. 先由董红卫确认做了查看权限控制的SKU数量---统计设置了部门可见的SKU数量
B. 
方案一： 根据OA组织架构映射到各个租户的组织架构 然后匹配每个SKU在租户的组织架构（数量很多时的方案）
  方案二： 直接对配置了权限控制的SKU一一修改（数量较少的方案）
C. 如果选择方案一，则租户的组织架构调用租户的组织架构接口

补充：因A点经确认SPU/SKU数量较多，因此确认选择方案一，需尽快确认当前OA组织架构和各个租户组织架构映射关系才能迁移数据（由华科来推动）


3.店铺可见（product_store_id）：牛蛙店铺可见来设置PMS对应的店铺（店铺刊登限制到PMS来配置）
      店铺可见有值则为哪些店铺才可刊登，同时，租户的PMS需要开放刊登范围限制界面供查询和配置租户内的店铺


4.平台和租户之间同步SKU时，平台决定哪些租户可见，再由租户自己配置哪些部门可见，默认部门都不可见（4.10周六会议朱经理补充的，二次过滤）